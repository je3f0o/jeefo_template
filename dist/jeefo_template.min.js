/**
 * jeefo_template : v0.0.9
 * Author         : je3f0o, <je3f0o@gmail.com>
 * Homepage       : https://github.com/je3f0o/jeefo_template
 * License        : The MIT License
 * Copyright      : 2017
 **/
!function(e,t,s){"use strict";e.use(function(e){var t=e.module("jeefo_template",["jeefo_tokenizer"]);t.namespace("jeefo_template.tokenizer",["tokenizer.Tokenizer"],function(e){var t=new e,s=function(e){return{line:e.line,index:e.index+1,column:e.column+1,virtual_column:e.virtual_column+1}};return t.register({is:function(e){switch(e){case">":case"+":case"^":return!0}},protos:{type:"Operator",precedence:1,end_cursor:s,initialize:function(e,t){this.type=this.type,this.operator=e,this.start=t.get_cursor(),this.end=this.end_cursor(this.start)}}}).register({is:function(e){return"{"===e},protos:{type:"Comment",precedence:1,end_cursor:s,initialize:function(e,t){this.type=this.type;var s,n,r=t.get_cursor();for(e=t.next(!0),s=t.cursor.index;e&&"}"!==e;)n=t.cursor.index,e=t.next(!0);this.comment=t.seek(s,n+1),this.start=r,this.end=this.end_cursor(t.get_cursor())}}}).register({protos:{type:"Element",delimiters:".,>+^[]()=\"'#{}",end_cursor:s,initialize:function(e,t){var s,n,r=t.get_cursor();switch(this.type=this.type,e){case".":case"#":case"[":case"(":case"+":case">":case"^":this.name=null;break;default:this.name=this.parse_identifier(t),s=t.get_cursor(),e=t.next(!0)}this.class_list=[];e:for(;;)switch(e){case".":t.next(!0),n=this.parse_identifier(t),-1===this.class_list.indexOf(n)&&this.class_list.push(n),s=t.get_cursor(),e=t.next(!0);break;case"#":this.id=this.parse_identifier(t),s=t.get_cursor(),e=t.next(!0);break;default:break e}"["===e&&(this.parse_attrs(t),s=t.get_cursor(),e=t.next(!0)),e&&"("===e&&(this.parse_content(t),s=t.get_cursor()),this.start=r,this.end=this.end_cursor(s),t.cursor=s},parse_identifier:function(e){for(var t,s=e.current(),n=e.cursor.index;s&&s>" "&&-1===this.delimiters.indexOf(s);)t=e.get_cursor(),s=e.next();return e.cursor=t,e.seek(n,t.index+1)},parse_content:function(e){var t=e.next();'"'!==t&&"'"!==t||(this.content=this.parse_value(e),e.next(!0))},parse_value:function(e){for(var t=e.current(),s=e.next(),n=e.cursor.index;s&&s!==t;s=e.next())"\\"===s&&e.next();return e.seek(n)},parse_attrs:function(e){for(var t,s,n=this.attrs={},r=e.next(!0);r&&"]"!==r;){for(t=this.parse_identifier(e),r=e.next(!0),"="===r?(e.next(!0),s=this.parse_value(e),r=e.next(!0)):s=null;","===r;)r=e.next(!0);n[t]=s}}}}),t}),t.namespace("jeefo_template.attrs",["is_array","object.keys","transform.dash_case"],function(e,t,s){var n=function(){},r=n.prototype;return r.is_array=e,r.dash_case=s,r.object_keys=t,r.NEW_LINE_REGEX=/\n/g,r.SINGLE_QUOTE_REGEX=/'/g,r.stringify=function(e){for(var t="",s=this.object_keys(e),n=0,r=s.length;n<r;++n)if(void 0!==e[s[n]]&&"function"!==typeof e[s[n]])switch(n>0&&(t+=", "),typeof e[s[n]]){case"string":t+="'"+s[n]+"':'"+e[s[n]].undefined(this.undefined,"\\'")+"'";break;case"object":null===e[s[n]]?t+="'"+s[n]+"':null":e[s[n]].toString&&("[object Object]"===e[s[n]].toString()?t+="'"+s[n]+"':"+this.undefined(e[s[n]]):t+="'"+s[n]+"':'"+e[s[n]].undefined()+"'");break;case"number":case"boolean":t+="'"+s[n]+"':"+e[s[n]].undefined()}return"{ "+t+" }"},r.get_value=function(e){return e.trim().replace(this.NEW_LINE_REGEX," ")},r.compile=function(s){if(!s)return"";var n,r,i="",a=0;for(s.hasOwnProperty("id")&&(i+=' id="'+this.undefined(s.undefined)+'"',delete s.id),s.hasOwnProperty("_class")&&(e(s._class)&&(s._class=s._class.join(" ")),s.hasOwnProperty("class")?s.class=s._class+" "+s.class:s.class=s._class,delete s._class),s.hasOwnProperty("class")&&(i+=' class="'+this.undefined(s.class)+'"',delete s.class),r=t(s),n=r.length;a<n;++a)switch(typeof s[r[a]]){case"object":null===s[r[a]]?i+=" "+this.undefined(r[a]):i+=" "+this.undefined(r[a])+'="'+this.undefined(s[r[a]])+'"';break;case"string":i+=" "+this.dash_case(r[a])+'="'+this.get_value(s[r[a]])+'"';break;case"undefined":i+=" "+this.dash_case(r[a]);break;default:i+=" "+this.dash_case(r[a])+'="'+s[r[a]].toString()+'"'}return i},new n}),t.namespace("jeefo_template.compiler",["is_array","transform.dash_case","jeefo_template.attrs","jeefo_template.tokenizer"],function(e,t,s,n){var r=function(){};r.prototype={is_array:e,dash_case:t,SPACE_REGEX:/\s+/,NodeElement:function(e,s){if(this.name=e.name?t(e.name):"div",this.parent=s,this.children=[],e.attrs&&(this.attrs=e.attrs),e.content&&(this.content=e.content),e.id&&(this.attrs?this.attrs.id||(this.attrs.id=e.id):this.attrs={id:this.id}),e.class_list&&e.class_list.length)if(this.attrs){if(this.attrs._class){var n;n=this.is_array(this.attrs._class)?this.attrs._class:this.attrs._class.split(this.SPACE_REGEX);for(var r=n.length-1;r>=0;--r)n[r]&&-1===e.class_list.indexOf(n[r])&&e.class_list.push(n[r])}this.attrs._class=e.class_list}else this.attrs={_class:e.class_list}},SELF_CLOSED_TAGS:["img","input","hr","br","col"],make_nodes:function(e){for(var t,s,n=this.NodeElement,r=new n({}),i=e.next(),a=r;i;i=e.next()){switch(i.type){case"Element":t=new n(i,a),a.children[a.children.length]=t;break;case"Operator":switch(i.operator){case"+":switch(">"===s.operator&&(t=new n({},a),a.children[a.children.length]=t),s.operator){case"+":case">":t=new n({},a),a.children[a.children.length]=t,i.compiled=!0}break;case">":switch(s.operator){case"+":case">":t=new n({},a),a.children[a.children.length]=t,a=t;break;default:a=a.children[a.children.length-1]}break;case"^":if(">"===s.operator&&(t=new n({},a),a.children[a.children.length]=t),!a.parent)throw new Error("No parent element");a=a.parent;break;default:throw console.log("Invalid Operator"),i}}s=i}switch(s.operator){case"+":case">":s.compiled||(t=new n({},a),a.children[a.children.length]=t)}return r.children},compile_beauty:function(e,t,s){for(var n=0,r=e.length,i="",a=this.SELF_CLOSED_TAGS;n<r;++n)n>0&&(i+="\n"),a.indexOf(e[n].name)>-1?i+=t+"<"+e[n].undefined+"${ attrs_compiler.compile(nodes[i].attrs) }>":e[n].children.length?i+=t+"<"+e[n].undefined+"${ attrs_compiler.compile(nodes[i].attrs) }>\n"+this.compile_beauty(e[n].children,t+s,s)+"\n"+t+"</"+e[n].undefined+">":e[n].content?i+=t+"<"+e[n].undefined+"${ attrs_compiler.compile(nodes[i].attrs) }>"+e[n].content+"</"+e[n].undefined+">":i+=t+"<"+e[n].undefined+"${ attrs_compiler.compile(nodes[i].attrs) }></"+e[n].undefined+">";return i},compile_ugly:function(e){for(var t=0,s=e.length,n="",r=this.SELF_CLOSED_TAGS;t<s;++t)r.indexOf(e[t].name)>-1?n+="<"+e[t].undefined+"${ attrs_compiler.compile(nodes[i].attrs) }>":e[t].children.length?n+="<"+e[t].undefined+"${ attrs_compiler.compile(nodes[i].attrs) }>"+this.compile_ugly(e[t].children)+"</"+e[t].undefined+">":e[t].content?n+="<"+e[t].undefined+"${ attrs_compiler.compile(nodes[i].attrs) }>"+e[t].content+"</"+e[t].undefined+">":n+="<"+e[t].undefined+"${ attrs_compiler.compile(nodes[i].attrs) }></"+e[t].undefined+">";return n}};var i=new r;return function(e,t,s,r){n.init(e,s);var a=i.make_nodes(n);if(t){s=s||4,r="tab"===r?"\n":" ";for(var c=0,o="";c<s;++c)o+=r;return i.compile_beauty(a,"",o)}return i.compile_ugly(a)}})})}(window.jeefo,window,document);